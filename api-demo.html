
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedena Game API Demo</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
            color: #e0e0e0;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .section {
            background: #2d2d2d;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #444;
        }
        .section h3 {
            margin-top: 0;
            color: #ffcc00;
            border-bottom: 2px solid #ffcc00;
            padding-bottom: 5px;
        }
        .controls {
            margin-bottom: 15px;
        }
        .controls input, .controls select, .controls textarea {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #555;
            border-radius: 4px;
            background: #333;
            color: #e0e0e0;
            box-sizing: border-box;
        }
        .controls button {
            background: #ffcc00;
            color: #000;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px 5px 5px 0;
            font-weight: bold;
        }
        .controls button:hover {
            background: #ffdd33;
        }
        .output {
            background: #1a1a1a;
            border: 1px solid #555;
            border-radius: 4px;
            padding: 10px;
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            min-height: 100px;
        }
        .full-width {
            grid-column: 1 / -1;
        }
        .game-interface {
            background: #2d2d2d;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        .status-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        .stat-card {
            background: #333;
            padding: 10px;
            border-radius: 4px;
            border-left: 4px solid #ffcc00;
        }
        .conversation-log {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #555;
            padding: 10px;
            background: #1a1a1a;
            margin-bottom: 15px;
        }
        .message {
            margin-bottom: 10px;
            padding: 8px;
            border-radius: 4px;
        }
        .user-message {
            background: #004d40;
            border-left: 3px solid #00bfa5;
        }
        .ai-message {
            background: #1a237e;
            border-left: 3px solid #3f51b5;
        }
    </style>
</head>
<body>
    <h1>üè∞ Pedena Game API Demo</h1>
    <p>Complete programmatic interface for running the Pedena RPG game.</p>

    <div class="container">
        <!-- API Initialization -->
        <div class="section">
            <h3>üöÄ API Initialization</h3>
            <div class="controls">
                <button onclick="initializeAPI()">Initialize API</button>
                <button onclick="getEndpoints()">Show Endpoints</button>
                <button onclick="setupAI()">Setup AI Function</button>
            </div>
            <div id="init-output" class="output"></div>
        </div>

        <!-- Character Management -->
        <div class="section">
            <h3>üë§ Character Management</h3>
            <div class="controls">
                <input type="text" id="char-name" placeholder="Character Name" value="TestHero">
                <select id="char-class">
                    <option value="warrior">Warrior</option>
                    <option value="mage">Mage</option>
                    <option value="rogue">Rogue</option>
                    <option value="ranger">Ranger</option>
                </select>
                <select id="char-gender">
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                </select>
                <button onclick="createCharacter()">Create Character</button>
                <button onclick="getPlayerData()">Get Player Data</button>
            </div>
            <div id="character-output" class="output"></div>
        </div>

        <!-- Location & Movement -->
        <div class="section">
            <h3>üó∫Ô∏è Location & Movement</h3>
            <div class="controls">
                <input type="text" id="destination" placeholder="Destination" value="Mystic Forest">
                <button onclick="getCurrentLocation()">Current Location</button>
                <button onclick="moveToLocation()">Move To Location</button>
            </div>
            <div id="location-output" class="output"></div>
        </div>

        <!-- Quest System -->
        <div class="section">
            <h3>üìú Quest System</h3>
            <div class="controls">
                <button onclick="generateQuest()">Generate Quest</button>
                <button onclick="getQuests()">View Quests</button>
                <button onclick="completeFirstQuest()">Complete First Quest</button>
            </div>
            <div id="quest-output" class="output"></div>
        </div>
    </div>

    <!-- Game Interface -->
    <div class="game-interface full-width">
        <h3>üéÆ Interactive Game Interface</h3>
        
        <!-- Player Status -->
        <div class="status-display" id="player-status">
            <div class="stat-card">
                <strong>Name:</strong> <span id="status-name">-</span><br>
                <strong>Class:</strong> <span id="status-class">-</span>
            </div>
            <div class="stat-card">
                <strong>Level:</strong> <span id="status-level">-</span><br>
                <strong>HP:</strong> <span id="status-hp">-</span>/<span id="status-maxhp">-</span>
            </div>
            <div class="stat-card">
                <strong>Gold:</strong> <span id="status-gold">-</span><br>
                <strong>Location:</strong> <span id="status-location">-</span>
            </div>
        </div>

        <!-- Conversation Log -->
        <div class="conversation-log" id="conversation-log">
            <p style="text-align: center; color: #666;">Conversation will appear here...</p>
        </div>

        <!-- Command Input -->
        <div class="controls">
            <input type="text" id="ai-command" placeholder="Enter your command (e.g., 'explore the area', 'attack the goblin', 'talk to the merchant')" value="explore the ancient ruins">
            <button onclick="processAICommand()">Execute Command</button>
            <button onclick="quickActions()">Quick Actions</button>
            <button onclick="clearConversation()">Clear Log</button>
        </div>

        <!-- Quick Actions -->
        <div class="controls">
            <button onclick="quickCommand('rest and recover')">Rest</button>
            <button onclick="quickCommand('explore the area')">Explore</button>
            <button onclick="quickCommand('look around')">Look Around</button>
            <button onclick="quickCommand('check inventory')">Inventory</button>
            <button onclick="quickCommand('cast a spell')">Cast Spell</button>
        </div>
    </div>

    <!-- Full Game State -->
    <div class="section full-width">
        <h3>üîç Complete Game State</h3>
        <div class="controls">
            <button onclick="getFullGameState()">Get Full State</button>
            <button onclick="saveGame()">Save Game</button>
            <button onclick="loadGame()">Load Game</button>
        </div>
        <div id="gamestate-output" class="output"></div>
    </div>

    <script type="module">
        import gameAPI from './game-api.js';

        // Make functions globally available
        window.gameAPI = gameAPI;

        // Simple AI function for demo purposes
        window.demoAI = async (prompt, temperature = 0.7, maxTokens = 800, includeContext = false) => {
            // Simulate AI processing delay
            await new Promise(resolve => setTimeout(resolve, 500));
            
            console.log('Demo AI Processing:', prompt.substring(0, 100) + '...');
            
            // Basic response generation based on command analysis
            if (prompt.includes('MOVEMENT')) {
                const destinations = ['Mystic Forest', 'Ancient Temple', 'Dragon\'s Lair', 'Peaceful Village', 'Mountain Pass'];
                const dest = destinations[Math.floor(Math.random() * destinations.length)];
                return `You journey through winding paths and arrive at ${dest}. The area has an air of mystery about it.`;
            } else if (prompt.includes('COMBAT')) {
                const outcomes = [
                    'You engage in fierce combat! After a challenging battle, you emerge victorious with 25 gold and 30 experience.',
                    'You fight bravely against your foe. Your skills prove superior as you defeat the enemy.',
                    'The battle is intense but you prevail! You find a healing potion among the defeated enemy\'s belongings.'
                ];
                return outcomes[Math.floor(Math.random() * outcomes.length)];
            } else if (prompt.includes('EXPLORATION')) {
                const discoveries = [
                    'You explore the area thoroughly and discover a hidden chest containing 50 gold coins!',
                    'Your investigation reveals ancient ruins with mysterious inscriptions. You feel wiser from the experience.',
                    'You find a secret passage behind some overgrown vines. It leads to a small chamber with valuable items.',
                    'While exploring, you encounter a friendly merchant who offers you a good deal on supplies.'
                ];
                return discoveries[Math.floor(Math.random() * discoveries.length)];
            } else if (prompt.includes('INTERACTION')) {
                const interactions = [
                    'You have a pleasant conversation and learn valuable information about the local area.',
                    'The person shares interesting stories about ancient legends and hidden treasures nearby.',
                    'Your discussion reveals a new quest opportunity that could prove quite rewarding.'
                ];
                return interactions[Math.floor(Math.random() * interactions.length)];
            } else if (prompt.includes('REST')) {
                return 'You find a safe place to rest. Your health is restored and you feel refreshed and ready for new adventures.';
            } else if (prompt.includes('MAGIC')) {
                return 'You channel magical energy and cast your spell. Sparks of mystical power dance around you as the magic takes effect.';
            } else {
                const general = [
                    'You take action with determination. Your efforts yield interesting results.',
                    'Something intriguing happens in response to your actions. The adventure continues!',
                    'Your choice leads to an unexpected but positive outcome.',
                    'You feel a sense of accomplishment as your action produces favorable results.'
                ];
                return general[Math.floor(Math.random() * general.length)];
            }
        };

        window.initializeAPI = async () => {
            const result = await gameAPI.initialize(window.demoAI);
            document.getElementById('init-output').textContent = JSON.stringify(result, null, 2);
            updateStatus();
        };

        window.setupAI = () => {
            const result = gameAPI.setAIFunction(window.demoAI);
            document.getElementById('init-output').textContent = JSON.stringify(result, null, 2);
        };

        window.getEndpoints = () => {
            const endpoints = gameAPI.getEndpoints();
            document.getElementById('init-output').textContent = JSON.stringify(endpoints, null, 2);
        };

        window.createCharacter = () => {
            const characterData = {
                name: document.getElementById('char-name').value,
                charClass: document.getElementById('char-class').value,
                gender: document.getElementById('char-gender').value,
                background: 'A brave adventurer seeking glory and treasure.'
            };
            
            const result = gameAPI.createCharacter(characterData);
            document.getElementById('character-output').textContent = JSON.stringify(result, null, 2);
            updateStatus();
        };

        window.getPlayerData = () => {
            const result = gameAPI.getPlayerData();
            document.getElementById('character-output').textContent = JSON.stringify(result, null, 2);
            updateStatus();
        };

        window.getCurrentLocation = () => {
            const result = gameAPI.getCurrentLocation();
            document.getElementById('location-output').textContent = JSON.stringify(result, null, 2);
        };

        window.moveToLocation = async () => {
            const destination = document.getElementById('destination').value;
            const result = await gameAPI.moveToLocation(destination);
            document.getElementById('location-output').textContent = JSON.stringify(result, null, 2);
            updateStatus();
        };

        window.generateQuest = async () => {
            const result = await gameAPI.generateQuest();
            document.getElementById('quest-output').textContent = JSON.stringify(result, null, 2);
        };

        window.getQuests = () => {
            const result = gameAPI.getQuests();
            document.getElementById('quest-output').textContent = JSON.stringify(result, null, 2);
        };

        window.completeFirstQuest = () => {
            const quests = gameAPI.getQuests();
            if (quests.length > 0) {
                const result = gameAPI.completeQuest(quests[0].id);
                document.getElementById('quest-output').textContent = JSON.stringify(result, null, 2);
                updateStatus();
            } else {
                document.getElementById('quest-output').textContent = 'No quests available to complete';
            }
        };

        window.processAICommand = async () => {
            const command = document.getElementById('ai-command').value;
            if (!command.trim()) return;
            
            // Add user message to log
            addToConversationLog('user', command);
            
            const result = await gameAPI.processCommand(command);
            
            // Add AI response to log
            if (result.response) {
                addToConversationLog('ai', result.response);
            }
            
            updateStatus();
            document.getElementById('ai-command').value = '';
        };

        window.quickCommand = async (command) => {
            document.getElementById('ai-command').value = command;
            await processAICommand();
        };

        window.quickActions = () => {
            alert('Quick Actions:\n‚Ä¢ Rest - Recover health\n‚Ä¢ Explore - Discover new things\n‚Ä¢ Look Around - Examine surroundings\n‚Ä¢ Inventory - Check items\n‚Ä¢ Cast Spell - Use magic');
        };

        window.getFullGameState = () => {
            const result = gameAPI.getGameState();
            document.getElementById('gamestate-output').textContent = JSON.stringify(result, null, 2);
        };

        window.saveGame = () => {
            const result = gameAPI.saveGame();
            document.getElementById('gamestate-output').textContent = JSON.stringify(result, null, 2);
        };

        window.loadGame = () => {
            const result = gameAPI.loadGame();
            document.getElementById('gamestate-output').textContent = JSON.stringify(result, null, 2);
            updateStatus();
        };

        window.clearConversation = () => {
            document.getElementById('conversation-log').innerHTML = '<p style="text-align: center; color: #666;">Conversation cleared...</p>';
        };

        function updateStatus() {
            const player = gameAPI.getPlayerData();
            if (player) {
                document.getElementById('status-name').textContent = player.name || '-';
                document.getElementById('status-class').textContent = player.class || '-';
                document.getElementById('status-level').textContent = player.level || '-';
                document.getElementById('status-hp').textContent = player.hp || '-';
                document.getElementById('status-maxhp').textContent = player.maxHp || '-';
                document.getElementById('status-gold').textContent = player.gold || '-';
                document.getElementById('status-location').textContent = player.currentLocation || '-';
            }
        }

        function addToConversationLog(type, message) {
            const log = document.getElementById('conversation-log');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}-message`;
            
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'user' ? 'üë§ You' : 'ü§ñ DM';
            
            messageDiv.innerHTML = `<strong>${prefix}</strong> <small>(${timestamp})</small><br>${message}`;
            
            log.appendChild(messageDiv);
            log.scrollTop = log.scrollHeight;
        }

        // Auto-initialize on page load
        window.addEventListener('load', async () => {
            await initializeAPI();
        });

        // Handle Enter key in command input
        document.addEventListener('DOMContentLoaded', () => {
            const commandInput = document.getElementById('ai-command');
            if (commandInput) {
                commandInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        processAICommand();
                    }
                });
            }
        });
    </script>
</body>
</html>
